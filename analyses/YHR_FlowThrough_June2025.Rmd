---
title: "YHR_FlowThrough_June2025"
output: html_document
date: "2025-12-08"
author: "Colin G. Finlay"
---

```{r setup, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE)
#use to set working directory 
knitr::opts_knit$set(root.dir="~/GitHub/FlowThrough_CoastalAg/analyses")
```

# Packages and data import

```{r load packages}
require("tidyverse")
require("ggpubr")
```

```{r read in data}
# Original flux calculation, used incorrect Ar concentration calculation:
Wk1_0730_MIMS <- read.csv("../data/Wk1_730MIMS_TimeCurves.csv")
Wk2_0731_MIMS <- read.csv("../data/Wk2_731MIMS_TimeCurves.csv")

# Fluxes with correct Ar calculation:
Wk1_0730_MIMS_V2 <- read.csv("../data/Ar_ReCalc_Dec2025/Wk1_730MIMS_TimeCurves.csv")
Wk2_0731_MIMS_V2 <- read.csv("../data/Ar_ReCalc_Dec2025/Wk2_731MIMS_TimeCurves.csv")
```

# Data wrangling

```{r}
# date times:
Wk1_0730_MIMS$Time <- as.POSIXct(Wk1_0730_MIMS$Time, format = "%m/%d/%y %H:%M")
Wk2_0731_MIMS$Time <- as.POSIXct(Wk2_0731_MIMS$Time, format = "%m/%d/%y %H:%M")

Wk1_0730_MIMS_V2$Time <- as.POSIXct(Wk1_0730_MIMS_V2$Time, format = "%m/%d/%y %H:%M")
Wk2_0731_MIMS_V2$Time <- as.POSIXct(Wk2_0731_MIMS_V2$Time, format = "%m/%d/%y %H:%M")
```

```{r split core IDs off of orig.ID}
Wk1_0730_MIMS$CoreID <- substr(Wk1_0730_MIMS$Orig.ID, 1, 3)
Wk2_0731_MIMS$CoreID <- substr(Wk2_0731_MIMS$Orig.ID, 1, 3)

Wk1_0730_MIMS_V2$CoreID <- substr(Wk1_0730_MIMS_V2$Orig_ID, 1, 3)
Wk2_0731_MIMS_V2$CoreID <- substr(Wk2_0731_MIMS_V2$Orig_ID, 1, 3)
```

# Plotting

## µM Ar

```{r µM Ar Week 1 old calculation}
plot.uM.Ar_Wk1 <- ggplot(data = Wk1_0730_MIMS, aes(x = Time, y = uM.Ar)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µM Ar")), title="Week 1 (June 9th, 2025)") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.uM.Ar_Wk1
```

```{r µM Ar Week 1 calculation V2}
plot.uM.Ar_Wk1_V2 <- ggplot(data = Wk1_0730_MIMS_V2, aes(x = Time, y = uM_Ar)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µM Ar")), title="Week 1 (June 9th, 2025)") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.uM.Ar_Wk1_V2
```

```{r µM Ar Week 2}
plot.uM.Ar_Wk2 <- ggplot(data = Wk2_0731_MIMS, aes(x = Time, y = uM.Ar)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µM Ar")), title="Week 2 (June 16th, 2025)") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.uM.Ar_Wk2
```

```{r µM Ar Week 2 calculation V2}
plot.uM.Ar_Wk2_V2 <- ggplot(data = Wk2_0731_MIMS_V2, aes(x = Time, y = uM_Ar)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µM Ar")), title="Week 2 (June 16th, 2025)") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.uM.Ar_Wk2_V2
```

## Ar flux

```{r Ar flux Week 1}
plot.Ar_flux_Wk1 <- ggplot(data = Wk1_0730_MIMS, aes(x = Time, y = Ar.flux..umol.Ar.m.2.hr.1.)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol Ar m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.Ar_flux_Wk1
```

```{r Ar flux Week 1 calculation V2}
plot.Ar_flux_Wk1_V2 <- ggplot(data = Wk1_0730_MIMS_V2, aes(x = Time, y = Ar_flux_umol_Ar_m.2_hr.1)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol Ar m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.Ar_flux_Wk1_V2
```

```{r Ar flux Week 2}
plot.Ar_flux_Wk2 <- ggplot(data = Wk2_0731_MIMS, aes(x = Time, y = Ar.flux..umol.Ar.m.2.hr.1.)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol Ar m"^{-2}, " h"^{-1})), title="") +
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.Ar_flux_Wk2
```

```{r Ar flux Week 2 calculation V2}
plot.Ar_flux_Wk2_V2 <- ggplot(data = Wk2_0731_MIMS_V2, aes(x = Time, y = Ar_flux_umol_Ar_m.2_hr.1)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol Ar m"^{-2}, " h"^{-1})), title="") +
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.Ar_flux_Wk2_V2
```

## N2 flux

```{r N2 flux Week 1}
plot.N2_flux_Wk1 <- ggplot(data = Wk1_0730_MIMS, aes(x = Time, y = N2.flux..umol.N.m.2.hr.1.)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol N"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.N2_flux_Wk1
```

```{r N2 flux Week 1 calculation V2}
plot.N2_flux_Wk1_V2 <- ggplot(data = Wk1_0730_MIMS_V2, aes(x = Time, y = N2_flux_umol_N_m.2_hr.1)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol N"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.N2_flux_Wk1_V2
```

```{r N2 flux Week 2}
plot.N2_flux_Wk2 <- ggplot(data = Wk2_0731_MIMS, aes(x = Time, y = N2.flux..umol.N.m.2.hr.1.)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol N"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.N2_flux_Wk2
```

```{r N2 flux Week 2 calculation V2}
plot.N2_flux_Wk2_V2 <- ggplot(data = Wk2_0731_MIMS_V2, aes(x = Time, y = N2_flux_umol_N_m.2_hr.1)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol N"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.N2_flux_Wk2_V2
```

## O2 flux

```{r O2 flux Week 1}
plot.O2_flux_Wk1 <- ggplot(data = Wk1_0730_MIMS, aes(x = Time, y = O2.flux..umol.O2.m.2.hr.1.)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol O"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_text(angle=45, hjust = 1))+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.O2_flux_Wk1
```

```{r O2 flux Week 1 calculation V2}
plot.O2_flux_Wk1_V2 <- ggplot(data = Wk1_0730_MIMS_V2, aes(x = Time, y = O2_flux_umol_O2_m.2_hr.1)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol O"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_text(angle=45, hjust = 1))+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.O2_flux_Wk1_V2
```

```{r O2 flux Week 2}
plot.O2_flux_Wk2 <- ggplot(data = Wk2_0731_MIMS, aes(x = Time, y = O2.flux..umol.O2.m.2.hr.1.)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol O"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_text(angle=45, hjust = 1))+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.O2_flux_Wk2
```

```{r O2 flux Week 2 calculation V2}
plot.O2_flux_Wk2_V2 <- ggplot(data = Wk2_0731_MIMS_V2, aes(x = Time, y = O2_flux_umol_O2_m.2_hr.1)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol O"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_text(angle=45, hjust = 1))+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.O2_flux_Wk2_V2
```

## ggarrange

```{r ggarrange calculation V1}
# Week 1
Wk1_fluxes_comb <- ggarrange(plotlist = c(plot.uM.Ar_Wk1, plot.Ar_flux_Wk1, plot.N2_flux_Wk1, plot.O2_flux_Wk1), ncol = 1, nrow = 4, align = "v")

Wk1_fluxes_comb

#ggsave("../figures/V1_bad_Ar_calc/Week1_fluxes.png", plot=Wk1_fluxes_comb, device="png", scale=1, width=21, height=16, dpi=600, limitsize=TRUE, bg="white")

# Week 2
Wk2_fluxes_comb <- ggarrange(plotlist = c(plot.uM.Ar_Wk2, plot.Ar_flux_Wk2, plot.N2_flux_Wk2, plot.O2_flux_Wk2), ncol = 1, nrow = 4, align = "v")

Wk2_fluxes_comb

#ggsave("../figures/V1_bad_Ar_calc/Week2_fluxes.png", plot=Wk2_fluxes_comb, device="png", scale=1, width=21, height=16, dpi=600, limitsize=TRUE, bg="white")
```

```{r ggarrange calculation V2}
# Week 1
Wk1_fluxes_comb_V2 <- ggarrange(plotlist = c(plot.uM.Ar_Wk1_V2, plot.Ar_flux_Wk1_V2, plot.N2_flux_Wk1_V2, plot.O2_flux_Wk1_V2), ncol = 1, nrow = 4, align = "v")

Wk1_fluxes_comb_V2

#ggsave("../figures/Week1_fluxes_V2.png", plot=Wk1_fluxes_comb_V2, device="png", scale=1, width=21, height=16, dpi=600, limitsize=TRUE, bg="white")

# Week 2
Wk2_fluxes_comb_V2 <- ggarrange(plotlist = c(plot.uM.Ar_Wk2_V2, plot.Ar_flux_Wk2_V2, plot.N2_flux_Wk2_V2, plot.O2_flux_Wk2_V2), ncol = 1, nrow = 4, align = "v")

Wk2_fluxes_comb_V2

#ggsave("../figures/Week2_fluxes_V2.png", plot=Wk2_fluxes_comb_V2, device="png", scale=1, width=21, height=16, dpi=600, limitsize=TRUE, bg="white")
```

```{r}

```

