---
title: "YHR_FlowThrough_June2025"
output: html_document
date: "2025-12-08"
author: "Colin G. Finlay"
---

```{r setup, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE)
#use to set working directory 
knitr::opts_knit$set(root.dir="~/GitHub/FlowThrough_CoastalAg/analyses")
```

# Packages and data import

```{r load packages}
require("tidyverse")
require("ggpubr")
require("ggtext")
require("xfun")
```

```{r read in data}
# Fluxes with correct Ar calculation:
Wk1_0730_MIMS_V3 <- read.csv("../data/Calc4_Jan2026/Wk1_730MIMS_TimeCurves.csv")
Wk2_0731_MIMS_V3 <- read.csv("../data/Calc4_Jan2026/Wk2_731MIMS_TimeCurves.csv")

# Terros 12 data from June and December 2025 (coordinates removed):
Teros12 <- read.csv("../data/Teros12_June_Dec_25.csv")
```

# Data wrangling

```{r format date times}
# date times:
Wk1_0730_MIMS_V3$Time <- as.POSIXct(Wk1_0730_MIMS_V3$Time, format = "%m/%d/%y %H:%M")
Wk2_0731_MIMS_V3$Time <- as.POSIXct(Wk2_0731_MIMS_V3$Time, format = "%m/%d/%y %H:%M")
```

```{r split core IDs off of orig.ID}
Wk1_0730_MIMS_V3$CoreID <- substr(Wk1_0730_MIMS_V3$Orig_ID, 1, 3)
Wk2_0731_MIMS_V3$CoreID <- substr(Wk2_0731_MIMS_V3$Orig_ID, 1, 3)
```

# Stats assumptions

```{r}

```


# Plotting

## µM Ar

```{r µM Ar Week 1 calculation V3}
plot.uM.Ar_Wk1_V3 <- ggplot(data = Wk1_0730_MIMS_V3, aes(x = Time, y = uM_Ar)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µM Ar")), title="Week 1 (June 9th, 2025)") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.uM.Ar_Wk1_V3
```

```{r µM Ar Week 2 calculation V3}
plot.uM.Ar_Wk2_V3 <- ggplot(data = Wk2_0731_MIMS_V3, aes(x = Time, y = uM_Ar)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µM Ar")), title="Week 2 (June 16th, 2025)") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.uM.Ar_Wk2_V3
```

## Ar flux

```{r Ar flux Week 1 calculation V3}
plot.Ar_flux_Wk1_V3 <- ggplot(data = Wk1_0730_MIMS_V3, aes(x = Time, y = Ar_flux_umol_Ar_m.2_hr)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol Ar m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.Ar_flux_Wk1_V3
```

```{r Ar flux Week 2 calculation V3}
plot.Ar_flux_Wk2_V3 <- ggplot(data = Wk2_0731_MIMS_V3, aes(x = Time, y = Ar_flux_umol_Ar_m.2_hr)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol Ar m"^{-2}, " h"^{-1})), title="") +
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.Ar_flux_Wk2_V3
```

# Flow rate

```{r Flow rate Week 1 calculation V3}
plot.FlowRate_Wk1_V3 <- ggplot(data = Wk1_0730_MIMS_V3, aes(x = Time, y = Flow_L_hr)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("Flow rate (L h"^{-1}, ")")), title="") +
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.FlowRate_Wk1_V3
```

```{r Flow rate Week 2 calculation V3}
plot.FlowRate_Wk2_V3 <- ggplot(data = Wk2_0731_MIMS_V3, aes(x = Time, y = Flow_L_hr)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("Flow rate (L h"^{-1}, ")")), title="") +
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.FlowRate_Wk2_V3
```

## N2-N flux

```{r N2-N flux Week 1 calculation V3}
plot.N_flux_Wk1_V3 <- ggplot(data = Wk1_0730_MIMS_V3, aes(x = Time, y = N2_flux_umol_N_m.2_hr)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
         labs(x = "", y = expression(paste("µMol N"[2], "-N m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.N_flux_Wk1_V3
```

```{r N2-N flux Week 2 calculation V3}
plot.N_flux_Wk2_V3 <- ggplot(data = Wk2_0731_MIMS_V3, aes(x = Time, y = N2_flux_umol_N_m.2_hr)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol N"[2], "-N m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_blank())+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.N_flux_Wk2_V3
```

## O2 flux

```{r O2 flux Week 1 calculation V3}
plot.O2_flux_Wk1_V3 <- ggplot(data = Wk1_0730_MIMS_V3, aes(x = Time, y = O2_flux_umol_O2_m.2_hr)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol O"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_text(angle=45, hjust = 1))+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-11 15:00:00", "2025-06-12 15:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.O2_flux_Wk1_V3
```

```{r O2 flux Week 2 calculation V3}
plot.O2_flux_Wk2_V3 <- ggplot(data = Wk2_0731_MIMS_V3, aes(x = Time, y = O2_flux_umol_O2_m.2_hr)) +
  facet_grid(~CoreID)+
  geom_line(linewidth = 1) +
  geom_point(size = 4)+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=20),axis.title=element_text(size=20,face="bold"),
          axis.text=element_text(size=20),  
          axis.title.y=element_text(margin=margin(r=10)),
          axis.title.x = element_text(margin = margin(r=10)),
          panel.border = element_rect(colour = "black",linewidth=1),strip.text = element_text(size = 20), legend.position="bottom", legend.title = element_text(size=20), legend.text=element_text(size=20)) + 
          theme(axis.ticks.length=unit(0.3,"cm")) + 
          labs(x = "", y = expression(paste("µMol O"[2], " m"^{-2}, " h"^{-1})), title="") +
  theme(rect=element_rect(fill="transparent"))+
  theme(plot.background = element_rect(color=NA), axis.text.x = element_text(angle=45, hjust = 1))+
  scale_x_datetime(breaks = "6 hours", limits = as.POSIXct(c("2025-06-18 13:00:00", "2025-06-19 13:00:00")), date_labels = "%m/%d %H:%M")
  
 
plot.O2_flux_Wk2_V3
```

## ggarrange

```{r ggarrange calculation V3}
# Week 1
Wk1_fluxes_comb_V3 <- ggarrange(plotlist = c(plot.uM.Ar_Wk1_V3, plot.Ar_flux_Wk1_V3, plot.FlowRate_Wk1_V3, plot.N_flux_Wk1_V3, plot.O2_flux_Wk1_V3), ncol = 1, nrow = 5, align = "v")

Wk1_fluxes_comb_V3

#ggsave("../figures/Week1_fluxes_V3.png", plot=Wk1_fluxes_comb_V3, device="png", scale=1, width=21, height=20, dpi=600, limitsize=TRUE, bg="white")

# Week 2
Wk2_fluxes_comb_V3 <- ggarrange(plotlist = c(plot.uM.Ar_Wk2_V3, plot.Ar_flux_Wk2_V3, plot.FlowRate_Wk2_V3, plot.N_flux_Wk2_V3, plot.O2_flux_Wk2_V3), ncol = 1, nrow = 5, align = "v")

Wk2_fluxes_comb_V3

#ggsave("../figures/Week2_fluxes_V3.png", plot=Wk2_fluxes_comb_V3, device="png", scale=1, width=21, height=20, dpi=600, limitsize=TRUE, bg="white")
```

# Drop outliers, average time points

```{r}
# Only clear outlier is A05 T1 (Week 1). In this case, both N2 and O2 fluxes are outliers, so we'll drop the entire T1 for A05
Wk1_0730_MIMS_V3 <- Wk1_0730_MIMS_V3 %>%
  filter(Orig_ID != "A05-T1")
```

```{r average the time point for each core}
# Create new data frame with averaged values, Week 1:
Core_Averages_Wk1 <- Wk1_0730_MIMS_V3 %>%
  group_by(CoreID) %>%
  summarise(
    Mean_N2_Flux = mean(N2_flux_umol_N_m.2_hr, na.rm = TRUE),
    Mean_O2_Flux = mean(O2_flux_umol_O2_m.2_hr, na.rm = TRUE)
  )

# Create new data frame with averaged values, Week 2:
Core_Averages_Wk2 <- Wk2_0731_MIMS_V3 %>%
  group_by(CoreID) %>%
  summarise(
    Mean_N2_Flux = mean(N2_flux_umol_N_m.2_hr, na.rm = TRUE),
    Mean_O2_Flux = mean(O2_flux_umol_O2_m.2_hr, na.rm = TRUE)
  )
```

```{r Add week labels, combine DFs, add site labels}
# Week 1 (June 9th, 2025)
Core_Averages_Wk1$Week <- "9-June-2025"
# Week 2 (June 16th, 2025)
Core_Averages_Wk2$Week <- "16-June-2025"

# Combine data frames
Core_Averages <- bind_rows(Core_Averages_Wk1, Core_Averages_Wk2)

# Add site labels (A, B, C)
Core_Averages <- Core_Averages %>%
  mutate(Plot = substr(CoreID, 1, 1))

# Add flood risk labels
Core_Averages <- Core_Averages %>%
  mutate(Flood = case_when(
    Plot == "A" ~ "Regulatory floodway",
    Plot == "B" ~ "1% Annual chance",
    Plot == "C" ~ "0.2% Annual chance",
    TRUE ~ NA_character_ # Optional: sets anything else to NA
  ))
```

```{r set factors}
Core_Averages$Plot <- as.factor(Core_Averages$Plot)

Core_Averages$Week <- factor(Core_Averages$Week, levels = c("9-June-2025", "16-June-2025"))
```

# Plotting

## Plotting both weeks

```{r N2-N flux both weeks}
# Plotting:
plot.N2_Wk1_Wk2 <- ggplot(Core_Averages, aes(x=Plot, y=Mean_N2_Flux)) +
  facet_wrap(vars(as.factor(Week)), nrow = 1, ncol = 2)+
                    geom_boxplot(aes(color=Plot), outlier.shape = NA) +
                    geom_point(aes(color=Plot), size = 2, position = position_jitterdodge()) +
  scale_color_manual(values=c("#86a8d2","#9c509f","#a88ec0"), labels = c("A: Regulatory Floodway", "B: 1% Annual Chance", "C: 0.2% Annual Chance"), name="Flood Hazard")+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=10), axis.title=element_text(size=10,face="bold"),
          axis.text=element_text(size=10, color = "black"),
          axis.text.x = element_text(angle = 0),panel.border = element_rect(colour = "black",size=1),strip.text = element_text(size = 10), legend.position="right", legend.title = element_text(size=10), legend.text=element_text(size=10)) + 
theme(axis.ticks.length = unit(0.3, "cm"), axis.title.y = element_markdown()) + 
  labs(x = "Flood Hazard", 
    # Use standard markdown (**) for bold and HTML (<sup>) for superscripts
    y = "**µmol N<sub>2</sub>-N m<sup>-2</sup> h<sup>-1</sup>**", title = "")
 
plot.N2_Wk1_Wk2

#ggsave("../figures/Ecosphere_pub/iris_tubes.tiff", plot=plot.IRIS_nested, device="tiff", path=NULL, scale=1, width= 18, height= 22, units = "cm", dpi=600, limitsize=TRUE, bg="white")
```

```{r O2 flux both weeks}
# Plotting:
plot.O2_Wk1_Wk2 <- ggplot(Core_Averages, aes(x=Plot, y=Mean_O2_Flux)) +
  facet_wrap(vars(as.factor(Week)), nrow = 1, ncol = 2)+
                    geom_boxplot(aes(color=Plot), outlier.shape = NA) +
                    geom_point(aes(color=Plot), size = 2, position = position_jitterdodge()) +
  scale_color_manual(values=c("#86a8d2","#9c509f","#a88ec0"), labels = c("A: Regulatory Floodway", "B: 1% Annual Chance", "C: 0.2% Annual Chance"), name="Flood Hazard")+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=10), axis.title=element_text(size=10,face="bold"),
          axis.text=element_text(size=10, color = "black"),
          axis.text.x = element_text(angle = 0),panel.border = element_rect(colour = "black",size=1),strip.text = element_text(size = 10), legend.position="right", legend.title = element_text(size=10), legend.text=element_text(size=10)) + 
theme(axis.ticks.length = unit(0.3, "cm"), axis.title.y = element_markdown()) + 
  labs(x = "Flood Hazard", 
    # Use standard markdown (**) for bold and HTML (<sup>) for superscripts
    y = "**µmol O<sub>2</sub> m<sup>-2</sup> h<sup>-1</sup>**", title = "")
 
plot.O2_Wk1_Wk2

#ggsave("../figures/Ecosphere_pub/iris_tubes.tiff", plot=plot.IRIS_nested, device="tiff", path=NULL, scale=1, width= 18, height= 22, units = "cm", dpi=600, limitsize=TRUE, bg="white")
```

## Plotting Week 1 only

```{r}
# remove Week 2 from Core_Averages
Core_Averages_Wk1 <- Core_Averages %>%
  filter(Week == "9-June-2025")
```

```{r N2-N flux week 1}
# Plotting:
plot.N2_Wk1 <- ggplot(Core_Averages_Wk1, aes(x=Plot, y=Mean_N2_Flux)) +
                    geom_boxplot(aes(color=Plot), outlier.shape = NA) +
                    geom_point(aes(color=Plot), size = 2, position = position_jitterdodge()) +
  scale_color_manual(values=c("#86a8d2","#9c509f","#a88ec0"), labels = c("A: Regulatory Floodway", "B: 1% Annual Chance", "C: 0.2% Annual Chance"), name="Flood Hazard")+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=10), axis.title=element_text(size=10,face="bold"),
          axis.text=element_text(size=10, color = "black"),
          axis.text.x = element_text(), panel.border = element_rect(colour = "black",size=1),strip.text = element_text(size = 10), legend.position="right", legend.title = element_text(size=10), legend.text=element_text(size=10)) + 
theme(axis.ticks.length = unit(0.3, "cm"), axis.title.y = element_markdown()) + 
  labs(x = "", 
    # Use standard markdown (**) for bold and HTML (<sup>) for superscripts
    y = "**µmol N<sub>2</sub>-N m<sup>-2</sup> h<sup>-1</sup>**", title = "")
 
plot.N2_Wk1

#ggsave("../figures/Ecosphere_pub/iris_tubes.tiff", plot=plot.IRIS_nested, device="tiff", path=NULL, scale=1, width= 18, height= 22, units = "cm", dpi=600, limitsize=TRUE, bg="white")
```

```{r O2 flux week 2}
# Plotting:
plot.O2_Wk1 <- ggplot(Core_Averages_Wk1, aes(x=Plot, y=Mean_O2_Flux)) +
                    geom_boxplot(aes(color=Plot), outlier.shape = NA) +
                    geom_point(aes(color=Plot), size = 2, position = position_jitterdodge()) +
  scale_color_manual(values=c("#86a8d2","#9c509f","#a88ec0"), labels = c("A: Regulatory Floodway", "B: 1% Annual Chance", "C: 0.2% Annual Chance"), name="Flood Hazard")+
  theme_bw() +
  #Remove plot grid lines
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  #Set axis title and text properties, tick marks, and labels
  theme(text=element_text(size=10), axis.title=element_text(size=10,face="bold"),
          axis.text=element_text(size=10, color = "black"),
          axis.text.x = element_text(angle = 0),panel.border = element_rect(colour = "black",size=1),strip.text = element_text(size = 10), legend.position="right", legend.title = element_text(size=10), legend.text=element_text(size=10)) + 
theme(axis.ticks.length = unit(0.3, "cm"), axis.title.y = element_markdown()) + 
  labs(x = "Flood Hazard", 
    # Use standard markdown (**) for bold and HTML (<sup>) for superscripts
    y = "**µmol O<sub>2</sub> m<sup>-2</sup> h<sup>-1</sup>**", title = "")
 
plot.O2_Wk1

#ggsave("../figures/Ecosphere_pub/iris_tubes.tiff", plot=plot.IRIS_nested, device="tiff", path=NULL, scale=1, width= 18, height= 22, units = "cm", dpi=600, limitsize=TRUE, bg="white")
```



```{r ggarrange}
Wk1_N2_O2_flux <- ggarrange(plot.N2_Wk1, plot.O2_Wk1, labels = c("(a)", "(b)"), ncol = 1, nrow = 2, legend = "right", common.legend = T, align = "hv")

Wk1_N2_O2_flux

#ggsave("../figures/Wk1_N2_O2_flux.png", plot=Wk1_N2_O2_flux, device="png", path=NULL, scale=1, width=18, height=22, units = "cm", dpi=600, limitsize=TRUE, bg="white")
```

